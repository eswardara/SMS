<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMS Dashboard</title>
  <link rel="shortcut icon" href="assets/images/favicon.png">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Leaflet CSS/JS CDN -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            glass: {
              DEFAULT: '#18181b', // black glass
              dark: '#111113',
              accent: '#dc2626', // red accent
            },
          },
        },
      },
    }
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #000000 0%, #040405 100%);
    }

    .card-glassy::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.07) 100%);
      pointer-events: none;
      z-index: 1;
    }

    .card-glassy>* {
      position: relative;
      z-index: 2;
    }

    .sidebar-tooltip,
    .nav-tooltip {
      @apply absolute left-full top-1/2 -translate-y-1/2 ml-2 px-2 py-1 rounded bg-black/80 text-white text-xs opacity-0 pointer-events-none whitespace-nowrap z-50 transition-all duration-300;
    }

    .nav-tooltip {
      @apply absolute left-1/2 top-full mt-1 -translate-x-1/2 px-2 py-1 rounded bg-black/80 text-white text-xs opacity-0 pointer-events-none whitespace-nowrap z-50 transition-all duration-300;
    }
  </style>
</head>

<body class="min-h-screen flex flex-col dark bg-glass-dark text-white">

  <!-- Horizontal Navigation Bar -->
  <nav
    class="fixed top-0 left-0 w-full flex items-center justify-between bg-glass/70 backdrop-blur-md shadow border-b border-glass-accent/10 px-4 md:px-8 py-2 z-20"
    style="backdrop-filter: blur(16px);">
    <div class="flex items-center gap-6">
      <!-- Army Insignia SVG (star badge) and Brand -->
      <div class="flex items-center gap-2">
        <img src="assets/images/logo.png" style="width:55%;display:inline;" class="object-center md:object-top" />
        <span class="text-base font-bold tracking-wide text-glass-accent hidden sm:inline">SMS</span>
      </div>
      <div class="flex gap-2 md:gap-4">
        <button onclick="showSection('dashboard')" aria-label="Dashboard"
          class="px-3 py-2 rounded-lg flex items-center hover:bg-glass-accent/10 transition group nav-btn"
          id="nav-dashboard">
          <span class="text-sm">Dashboard</span>
        </button>
        <button onclick="showSection('user-creation')" aria-label="User Creation"
          class="px-3 py-2 rounded-lg flex items-center hover:bg-glass-accent/10 transition group nav-btn"
          id="nav-user-creation">
          <span class="text-sm">User Creation</span>
        </button>
        <button onclick="showSection('user-list')" aria-label="User List"
          class="px-3 py-2 rounded-lg flex items-center hover:bg-glass-accent/10 transition group nav-btn"
          id="nav-user-list">
          <span class="text-sm">User List</span>
        </button>
        <button onclick="showSection('settings')" aria-label="Settings"
          class="px-3 py-2 rounded-lg flex items-center hover:bg-glass-accent/10 transition group nav-btn"
          id="nav-settings">
          <span class="text-sm">Settings</span>
        </button>
      </div>
    </div>
    <div class="flex items-center gap-2">
      <!-- Notifications Bell Icon -->
      <button aria-label="Notifications"
        class="relative mx-2 p-2 rounded-full hover:bg-glass-accent/20 transition focus:outline-none">
        <svg class="w-7 h-7 text-glass-accent" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6.002 6.002 0 0 0-4-5.659V5a2 2 0 1 0-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 1 1-6 0v-1m6 0H9" />
        </svg>
        <span class="absolute top-1 right-1 w-2 h-2 bg-blue-500 rounded-full animate-pulse"></span>
      </button>
      <!-- User Profile Dropdown -->
      <div class="relative ml-2">
        <button id="userMenuBtn" aria-label="User menu"
          class="flex items-center gap-2 p-2 rounded-full hover:bg-glass-accent/20 transition focus:outline-none">
          <img src="https://ui-avatars.com/api/?name=SMS+User&background=3b82f6&color=fff&rounded=true&size=32"
            alt="User Avatar" class="w-8 h-8 rounded-full border-2 border-glass-accent" />
          <span class="hidden md:inline text-white font-medium">SMS User</span>
          <svg class="w-4 h-4 text-glass-accent" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div id="userDropdown" class="hidden absolute right-0 mt-2 w-40 bg-glass/90 rounded-lg shadow-lg py-2 z-50">
          <a href="#" class="block px-4 py-2 text-white hover:bg-glass-accent/20">Profile</a>
          <a href="#" class="block px-4 py-2 text-white hover:bg-glass-accent/20">Settings</a>
          <div class="border-t border-glass-accent/20 my-1"></div>
          <a href="index.html" class="block px-4 py-2 text-white hover:bg-glass-accent/20">Logout</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div id="mainContent" class="flex-1 flex flex-col transition-all duration-300 mt-20">
   
      <!-- Settings Section -->
      <div id="settings" class="section hidden">
        <h2 class="text-2xl font-bold mb-6 pl-6 mt-5">Settings</h2>
        <div class="max-w-lg mx-auto bg-white/20 backdrop-blur-xl border border-white/30 shadow-2xl rounded-2xl p-8">
          <h3 class="text-lg font-semibold mb-4 text-glass-accent">Change Password</h3>
          <form id="changePasswordForm" class="space-y-6">
            <div>
              <label for="currentPassword" class="block mb-2 font-semibold">Current Password</label>
              <input type="password" id="currentPassword" required
                class="w-full px-4 py-2 rounded-lg bg-glass-dark/60 border border-white focus:outline-none focus:ring-2 focus:ring-white" placeholder="Enter current password">
            </div>
            <div>
              <label for="newPassword" class="block mb-2 font-semibold">New Password</label>
              <input type="password" id="newPassword" required
                class="w-full px-4 py-2 rounded-lg bg-glass-dark/60 border border-white focus:outline-none focus:ring-2 focus:ring-white" placeholder="Enter new password">
            </div>
            <div>
              <label for="confirmPassword" class="block mb-2 font-semibold">Confirm New Password</label>
              <input type="password" id="confirmPassword" required
                class="w-full px-4 py-2 rounded-lg bg-glass-dark/60 border border-white focus:outline-none focus:ring-2 focus:ring-white" placeholder="Confirm new password">
            </div>
            <div class="flex justify-end">
              <button type="submit" class="bg-glass-accent text-glass-dark px-6 py-2 rounded-lg font-bold hover:bg-glass-accent/80 transition">Change Password</button>
            </div>
            <div id="changePasswordMsg" class="mt-2 text-sm"></div>
          </form>
        </div>
      </div>
    </main>
  </div>
  <footer class="w-full bg-glass/70 backdrop-blur-md border-t border-glass-accent/10 text-center py-2 text-xs text-white mt-auto" style="backdrop-filter: blur(16px);">
    &copy; 2025 Soldier Management System
  </footer>
  <script>
    // Show/hide sections
    function showSection(section) {
      document.querySelectorAll('.section').forEach(div => div.classList.add('hidden'));
      document.getElementById(section).classList.remove('hidden');
      if (section === 'user-list') {
        renderUserListTable();
      }
      if (section === 'settings') {
        document.getElementById('changePasswordForm').reset();
        document.getElementById('changePasswordMsg').textContent = '';
      }
    }
    // Show dashboard by default
    showSection('dashboard');

    // In-memory user data (expanded for paging demo)
    let users = [
      { username: 'john.doe', email: 'john@army.com', role: 'Officer', department: 'Infantry', status: 'Active' },
      { username: 'priya.singh', email: 'priya@army.com', role: 'Soldier', department: 'Artillery', status: 'Active' },
      { username: 'amit.kumar', email: 'amit@army.com', role: 'Admin', department: 'Administration', status: 'Active' },
      { username: 'sara.ali', email: 'sara@army.com', role: 'Officer', department: 'Medical', status: 'Active' },
      { username: 'mike.jones', email: 'mike@army.com', role: 'Soldier', department: 'Infantry', status: 'Inactive' },
      { username: 'lisa.wong', email: 'lisa@army.com', role: 'Officer', department: 'Intelligence', status: 'Active' },
      { username: 'tom.smith', email: 'tom@army.com', role: 'Admin', department: 'Engineering', status: 'Active' },
      { username: 'emma.brown', email: 'emma@army.com', role: 'Soldier', department: 'Navy', status: 'Active' },
      { username: 'alex.lee', email: 'alex@army.com', role: 'Officer', department: 'Air Force', status: 'Inactive' },
      { username: 'nina.patel', email: 'nina@army.com', role: 'Admin', department: 'Medical', status: 'Active' },
      { username: 'rajiv.gupta', email: 'rajiv@army.com', role: 'Soldier', department: 'Infantry', status: 'Active' },
      { username: 'olga.ivanova', email: 'olga@army.com', role: 'Officer', department: 'Artillery', status: 'Active' },
    ];
    // Pagination state
    let currentPage = 1;
    const usersPerPage = 5;
    function renderUserTable() {
      const tbody = document.getElementById('userTableBody');
      tbody.innerHTML = '';
      const startIdx = (currentPage - 1) * usersPerPage;
      const endIdx = startIdx + usersPerPage;
      const pageUsers = users.slice(startIdx, endIdx);
      pageUsers.forEach((user, i) => {
        tbody.innerHTML += `
          <tr class="${i % 2 === 0 ? 'bg-white/10' : 'bg-white/5'} hover:bg-white/20 transition rounded-xl">
            <td class="py-3 px-4">${user.username}</td>
            <td class="py-3 px-4">${user.email}</td>
            <td class="py-3 px-4">${user.role}</td>
            <td class="py-3 px-4">${user.department}</td>
            <td class="py-3 px-4">${user.status}</td>
          </tr>
        `;
      });
      renderPagination();
    }
    function renderPagination() {
      const controls = document.getElementById('paginationControls');
      controls.innerHTML = '';
      const totalPages = Math.ceil(users.length / usersPerPage);
      for (let i = 1; i <= totalPages; i++) {
        controls.innerHTML += `<button onclick="gotoPage(${i})" class="px-4 py-2 rounded-full border border-white/40 bg-white/20 text-white font-semibold shadow hover:bg-white/30 hover:text-glass-accent transition-all duration-200 ${i === currentPage ? 'ring-2 ring-white/60 scale-105' : ''}">${i}</button>`;
      }
    }
    function gotoPage(page) {
      currentPage = page;
      renderUserTable();
    }
    // Initial render for user table if user-creation section is shown
    document.addEventListener('DOMContentLoaded', () => {
      renderUserTable();
    });
    // User List Section rendering (separate from user creation)
    function renderUserListTable() {
      const tbody = document.getElementById('userTableBodyList');
      if (!tbody) return;
      tbody.innerHTML = '';
      const startIdx = (currentPage - 1) * usersPerPage;
      const endIdx = startIdx + usersPerPage;
      const pageUsers = users.slice(startIdx, endIdx);
      pageUsers.forEach((user, i) => {
        tbody.innerHTML += `
          <tr class="${i % 2 === 0 ? 'bg-white/10' : 'bg-white/5'} hover:bg-white/20 transition rounded-xl">
            <td class="py-3 px-4">${user.username}</td>
            <td class="py-3 px-4">${user.email}</td>
            <td class="py-3 px-4">${user.role}</td>
            <td class="py-3 px-4">${user.department}</td>
            <td class="py-3 px-4">${user.status}</td>
          </tr>
        `;
      });
      renderPaginationList();
    }
    function renderPaginationList() {
      const controls = document.getElementById('paginationControlsList');
      if (!controls) return;
      controls.innerHTML = '';
      const totalPages = Math.ceil(users.length / usersPerPage);
      for (let i = 1; i <= totalPages; i++) {
        controls.innerHTML += `<button onclick="gotoPageList(${i})" class="px-4 py-2 rounded-full border border-white/40 bg-white/20 text-white font-semibold shadow hover:bg-white/30 hover:text-glass-accent transition-all duration-200 ${i === currentPage ? 'ring-2 ring-white/60 scale-105' : ''}">${i}</button>`;
      }
    }
    function gotoPageList(page) {
      currentPage = page;
      renderUserListTable();
    }
    // Add user
    document.getElementById('userForm').onsubmit = function (e) {
      e.preventDefault();
      // Gather all form fields
      const user = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        dob: document.getElementById('dob').value,
        profilePic: document.getElementById('profilePic').value.trim(),
        username: document.getElementById('username').value.trim(),
        role: document.getElementById('role').value,
        rank: document.getElementById('rank').value,
        department: document.getElementById('department').value,
        serviceNumber: document.getElementById('serviceNumber').value.trim(),
        joinDate: document.getElementById('joinDate').value,
        address: document.getElementById('address').value.trim(),
        city: document.getElementById('city').value.trim(),
        state: document.getElementById('state').value.trim(),
        zipCode: document.getElementById('zipCode').value.trim(),
        country: document.getElementById('country').value.trim(),
        emergencyName: document.getElementById('emergencyName').value.trim(),
        emergencyPhone: document.getElementById('emergencyPhone').value.trim(),
        emergencyRelation: document.getElementById('emergencyRelation').value,
        emergencyEmail: document.getElementById('emergencyEmail').value.trim(),
        bloodGroup: document.getElementById('bloodGroup').value,
        maritalStatus: document.getElementById('maritalStatus').value,
        notes: document.getElementById('notes').value.trim(),
      };
      if (user.username && user.email && user.role) {
        users.push(user);
        renderRolesTable(); // This function is no longer used for the user list
        addActivity(`Created user <b>${user.username}</b> as <b>${user.role}</b>.`);
        this.reset();
        showSection('user-list'); // Show the user list section
      }
    };
    // Edit user
    function editUser(idx) {
      const user = users[idx];
      document.getElementById('username').value = user.username;
      document.getElementById('email').value = user.email;
      document.getElementById('role').value = user.role;
      showSection('user-list'); // Show the user list section
      // Remove user for update
      users.splice(idx, 1);
      renderUserListTable();
    }
    // Delete user
    function deleteUser(idx) {
      addActivity(`Deleted user <b>${users[idx].username}</b>.`);
      users.splice(idx, 1);
      renderUserListTable();
    }
    // Dashboard widgets update
    function updateDashboard() {
      // Active Users
      document.getElementById('activeUsers').textContent = users.length;
      // Roles Assigned (unique roles)
      const uniqueRoles = new Set(users.map(u => u.role));
      document.getElementById('rolesAssigned').textContent = uniqueRoles.size;
      // Pending Requests (sample: 3)
      document.getElementById('pendingRequests').textContent = 3;
      // Bar chart widths
      const roleCounts = { Admin: 0, Officer: 0, Soldier: 0 };
      users.forEach(u => roleCounts[u.role] = (roleCounts[u.role] || 0) + 1);
      document.getElementById('bar-admin').style.width = (roleCounts.Admin * 30 + 10) + 'px';
      document.getElementById('bar-officer').style.width = (roleCounts.Officer * 30 + 10) + 'px';
      document.getElementById('bar-soldier').style.width = (roleCounts.Soldier * 30 + 10) + 'px';
    }
    // Recent activity
    let activity = [];
    function addActivity(msg) {
      activity.unshift({ msg, time: new Date() });
      renderActivity();
    }
    function renderActivity() {
      const ul = document.getElementById('recentActivity');
      if (activity.length === 0) {
        ul.innerHTML = '<li>No recent activity.</li>';
        return;
      }
      ul.innerHTML = activity.slice(0, 5).map(a => `<li><span class='text-glass-accent/80'>${a.time.toLocaleTimeString()}</span> - <span>${a.msg}</span></li>`).join('');
    }
    // Initial render
    renderUserListTable(); // Initial render for user list
    renderActivity();
    // Chart.js widgets
    window.addEventListener('DOMContentLoaded', () => {
      // Troop Distribution Pie Chart
      const troopPie = document.getElementById('troopPie').getContext('2d');
      new Chart(troopPie, {
        type: 'pie',
        data: {
          labels: ['Infantry', 'Armored', 'Artillery', 'Air Force', 'Navy'],
          datasets: [{
            data: [40, 20, 15, 15, 10],
            backgroundColor: [
              '#fff',
              '#22c55e',
              '#dc2626',
              '#fff',
              '#22c55e'
            ],
            borderWidth: 1,
            borderColor: 'rgba(255,255,255,0.2)'
          }]
        },
        options: {
          plugins: {
            legend: {
              labels: { color: '#fff', font: { weight: 'bold' } },
              display: true,
              align: 'start',
              position: 'top',
              maxHeight: 30,
              maxWidth: 400,
              fullSize: false
            },
            title: {
              display: false
            }
          }
        }
      });
      // Mission Status Bar Chart
      const missionBar = document.getElementById('missionBar').getContext('2d');
      new Chart(missionBar, {
        type: 'bar',
        data: {
          labels: ['Completed', 'Ongoing', 'Planned', 'Delayed'],
          datasets: [{
            label: 'Missions',
            data: [12, 5, 7, 2],
            backgroundColor: [
              '#22c55e',
              '#fff',
              '#dc2626',
              '#22c55e'
            ],
            borderRadius: 6
          }]
        },
        options: {
          plugins: {
            legend: { display: true, labels: { color: '#fff', font: { weight: 'bold' } }, align: 'start', position: 'top', maxHeight: 30, maxWidth: 400, fullSize: false },
          },
          scales: {
            x: {
              ticks: { color: '#fff', font: { weight: 'bold' } },
              grid: { color: 'rgba(255,255,255,0.05)' }
            },
            y: {
              ticks: { color: '#fff', font: { weight: 'bold' } },
              grid: { color: 'rgba(255,255,255,0.05)' }
            }
          }
        }
      });
      // Leaflet interactive map
      if (document.getElementById('leafletMap')) {
        var map = L.map('leafletMap').setView([22.5937, 78.9629], 4);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 18,
          attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);
        // Marker for India
        L.marker([22.5937, 78.9629]).addTo(map).bindPopup('India HQ').openPopup();
      }
      // User Growth Line Chart
      if (document.getElementById('userGrowthChart')) {
        const userGrowthCtx = document.getElementById('userGrowthChart').getContext('2d');
        new Chart(userGrowthCtx, {
          type: 'line',
          data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'],
            datasets: [{
              label: 'Users',
              data: [2, 3, 4, 6, 8, 10, 11, 12],
              borderColor: '#22c55e',
              backgroundColor: 'rgba(34,197,94,0.2)',
              fill: true,
              tension: 0.4,
              pointBackgroundColor: '#fff',
              pointBorderColor: '#22c55e',
              pointRadius: 5,
            }]
          },
          options: {
            plugins: {
              legend: { labels: { color: '#fff', font: { weight: 'bold' } }, align: 'start', position: 'top', maxHeight: 30, maxWidth: 400, fullSize: false },
            },
            scales: {
              x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.05)' } },
              y: { ticks: { color: '#fff' }, grid: { color: 'rgba(255,255,255,0.05)' } }
            }
          }
        });
      }
      // Role Distribution Doughnut Chart
      if (document.getElementById('roleDoughnutChart')) {
        const roleDoughnutCtx = document.getElementById('roleDoughnutChart').getContext('2d');
        new Chart(roleDoughnutCtx, {
          type: 'doughnut',
          data: {
            labels: ['Admin', 'Officer', 'Soldier'],
            datasets: [{
              data: [4, 5, 3],
              backgroundColor: [
                '#22c55e',
                '#fff',
                '#dc2626'
              ],
              borderWidth: 1,
              borderColor: 'rgba(255,255,255,0.2)'
            }]
          },
          options: {
            plugins: {
              legend: { labels: { color: '#fff', font: { weight: 'bold' } }, align: 'start', position: 'top', maxHeight: 30, maxWidth: 400, fullSize: false },
              title: { display: false }
            }
          }
        });
      }
      // Skill Matrix Radar Chart
      if (document.getElementById('skillRadarChart')) {
        const skillRadarCtx = document.getElementById('skillRadarChart').getContext('2d');
        new Chart(skillRadarCtx, {
          type: 'radar',
          data: {
            labels: ['Leadership', 'Strategy', 'Fitness', 'Tech', 'Medical', 'Logistics'],
            datasets: [
              {
                label: 'Admin',
                data: [7, 6, 5, 8, 4, 7],
                backgroundColor: 'rgba(34,197,94,0.2)',
                borderColor: '#22c55e',
                pointBackgroundColor: '#fff',
                pointBorderColor: '#22c55e',
              },
              {
                label: 'Officer',
                data: [8, 8, 7, 6, 5, 6],
                backgroundColor: 'rgba(255,255,255,0.2)',
                borderColor: '#fff',
                pointBackgroundColor: '#22c55e',
                pointBorderColor: '#fff',
              }
            ]
          },
          options: {
            plugins: {
              legend: { labels: { color: '#fff', font: { weight: 'bold' } }, align: 'start', position: 'top', maxHeight: 30, maxWidth: 400, fullSize: false },
              title: { display: false }
            },
            scales: {
              r: {
                angleLines: { color: '#fff' },
                grid: { color: 'rgba(255,255,255,0.1)' },
                pointLabels: { color: '#fff', font: { weight: 'bold' } },
                ticks: { color: '#fff' }
              }
            }
          }
        });
      }
      // Department Strength Polar Area Chart
      if (document.getElementById('deptPolarChart')) {
        const deptPolarCtx = document.getElementById('deptPolarChart').getContext('2d');
        new Chart(deptPolarCtx, {
          type: 'polarArea',
          data: {
            labels: ['Infantry', 'Artillery', 'Medical', 'Engineering', 'Navy'],
            datasets: [{
              data: [12, 8, 6, 7, 5],
              backgroundColor: [
                '#22c55e',
                '#fff',
                '#dc2626',
                '#22c55e',
                '#fff'
              ],
              borderColor: 'rgba(255,255,255,0.2)',
              borderWidth: 1
            }]
          },
          options: {
            plugins: {
              legend: { labels: { color: '#fff', font: { weight: 'bold' } }, align: 'start', position: 'top', maxHeight: 30, maxWidth: 400, fullSize: false },
              title: { display: false }
            },
            scales: {
              r: {
                angleLines: { color: '#fff' },
                grid: { color: 'rgba(255,255,255,0.1)' },
                pointLabels: { color: '#fff', font: { weight: 'bold' } },
                ticks: { color: '#fff' }
              }
            }
          }
        });
      }
    });
    // Highlight active nav button
    function highlightNav(section) {
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('bg-glass-accent/20', 'text-glass-accent'));
      const navBtn = document.getElementById('nav-' + section);
      if (navBtn) navBtn.classList.add('bg-glass-accent/20', 'text-glass-accent');
    }
    // Update showSection to highlight active
    const origShowSection = showSection;
    showSection = function (section) {
      origShowSection(section);
      highlightNav(section);
    }
    // Hide nav tooltips by default
    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.nav-tooltip').forEach(t => t.classList.add('hidden'));
    });
    // User profile dropdown
    const userMenuBtn = document.getElementById('userMenuBtn');
    const userDropdown = document.getElementById('userDropdown');
    if (userMenuBtn && userDropdown) {
      userMenuBtn.addEventListener('click', () => {
        userDropdown.classList.toggle('hidden');
      });
      document.addEventListener('click', (e) => {
        if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
          userDropdown.classList.add('hidden');
        }
      });
    }
    // Add JS for change password form (demo only, no backend)
    document.getElementById('changePasswordForm').onsubmit = function(e) {
      e.preventDefault();
      const current = document.getElementById('currentPassword').value;
      const npass = document.getElementById('newPassword').value;
      const cpass = document.getElementById('confirmPassword').value;
      const msg = document.getElementById('changePasswordMsg');
      if (!current || !npass || !cpass) {
        msg.textContent = 'All fields are required.';
        msg.className = 'mt-2 text-sm text-red-500';
        return;
      }
      if (npass !== cpass) {
        msg.textContent = 'New passwords do not match.';
        msg.className = 'mt-2 text-sm text-red-500';
        return;
      }
      if (npass.length < 6) {
        msg.textContent = 'Password must be at least 6 characters.';
        msg.className = 'mt-2 text-sm text-red-500';
        return;
      }
      msg.textContent = 'Password changed successfully (demo only).';
      msg.className = 'mt-2 text-sm text-green-500';
      this.reset();
    };
  </script>
</body>

</html>